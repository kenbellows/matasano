<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Single-byte XOR cipher</title>
  </head>
  <body>
  <p>
    Enter a single-byte XORd ciphertext then hit "Convert" to decode it.
  </p>
  <p>
    <h4>
      XORd Ciphertext
    </h4>
    <textarea id="cipher" name="cipher" cols="30" rows="10"></textarea>
  </p>
  <p>
    <h4>
      Plaintext
    </h4>
    <textarea id="plain" name="plain" cols="30" rows="10"></textarea>
  </p>
  <p>
    <button onclick="go()">Convert</button>
  </p>
  <script>
  function go() {
    document.getElementById("plain").value = decode(document.getElementById("cipher").value);
  }
  
  function decode(cipher) {
    var winner = "",
        winning_score = 0;
    for (var xor_byte=0; xor_byte<0xff; xor_byte++) {
      var plaintext = "";
      for (var j=0; j<cipher.length; j++) plaintext += String.fromCharCode(cipher.charCodeAt(j)^xor_byte);
      var this_score = score(plaintext);
      if (this_score > winning_score) {
        winning_score = this_score;
        winner = plaintext;
      }
    }
    return winner;
  }
  var frequencies = "etaoinshrdlcumwfgypbvkjxqz";
  function score(plaintext) {
    var _score = 0;
    for (var i=0; i<plaintext.length; i++) {
      var chr = plaintext.charAt(i).toLowerCase(),
          freq = frequencies.indexOf(chr);
      if (chr > 0x7e || chr < 0x20) return 0; // any non-printable characters render this string a loser
      if (freq != -1) _score += frequencies.length - freq;
    }
    return _score;
  }
  </script>
  </body>
</html>

